---
title:  "Chap 5. 회귀분석 _ 5.1 기울기와 상관관계 추론" 
excerpt: "통계학입문 수업 스터디 노트"

categories:
  - Statistics
tags:
  - [Statistics]

toc: true
toc_sticky: true
 
date: 2021-12-14
last_modified_at: 2021-12-14

---

양적변수 두 개 사이의 관계를 상관관계와 회귀직선으로 설명하였다. 붓스트랩 분포와 임의화 검증으로 상관관계와 기울기를 추론하는 방법도 다뤘다. 이 장은 두 개의 양적변수의 관계를 이론적인 분포를 사용하여 추론할 것이다. 

## 단순 선형회귀 모형


단순 선형회귀 모형에서 반응변수 $$Y$$와 설명변수 $$X$$는 모두 양적 변수이다. $$X$$가 증가함에 따라 $$Y$$의 값은 직선 형태로 증가하거나 감소하는 경향이 있다고 가정한다. 

선형회귀 모형은 두 부분으로 구성된다. 하나는 반응변수와 설명변수 관계의 주요 추세를 나타내는 부분이고, 다른 하나는 오차항으로 개별 편차가 추세에서 벗어나는 것을 허용한다. 절편과 기울기로 이루어진 단순 회귀분석은 데이터의 전반적인 추세를 나타내고, 각 개별 데이터는 회귀직선의 아래$$\cdot$$위로 흩어져 있다. 

*관계의 주요 추세는 회귀선을 따라 데이터가 응집하는 것, 오차항은 회귀선에 모든 데이터가 맞을 순 없기 때문에 회귀선과 데이터 사이의 편차를 나타내는 것이다*

### 표기

표본에서 최소제곱 회귀선은 $$\hat Y = a + bX$$로 표기하였다. 하지만 회귀분석을 다루는 장에서는 아래와 같이 표기한다. 

$$
\hat Y = \beta_0 + \beta_1X
$$

또한 모집단에서 단순 선형회귀 모형은 오차항을 추가한다. 

$$
\hat Y = \beta_0 + \beta_1X + \epsilon
$$

모형에서 직선식$$(β0+β1X)$$은 X의 변화에 따른 Y의 평균적인 변화이다. 오차항(ϵ)은 반응변수 Y가 모형의 위 또는 아래로 변하는 것을 허용한다. 

모집단의 평균 μ와 비율 p를 표본에서 추정했던 것처럼, 모집단의 기울기와 절편도 표본으로부터 추정한다. 회귀선을 추정한 후 개별 오차항을 추정할 수 있다.

## 기울기에 대한 추론

회귀선을 추정한다면 당연히 기울기와 절편을 표본을 통해서 추정하게 된다. 현대에 이르러 컴퓨터를 통해 쉽게 기울기와 절편을 구하여 오차가 가장 적은 회귀선을 추정할 수 있지만 간단하게나마 기울기를 어떻게 추정하는지 알아보자. 

![image](https://user-images.githubusercontent.com/67791317/145940747-84ccc6a3-a20b-424d-92d5-da5278355b02.png){: .align-center}

위 데이터를 기반으로 기울기의 붓스트랩 분포 (표본 1000개), 임의화 분포(표본 1000개)를 뽑아보았다. 

<붓스트랩>

![image](https://user-images.githubusercontent.com/67791317/145941161-6b65d93f-4656-4503-8b8e-70b88a3c3169.png){: .align-center}

<임의화 분포> 

![image](https://user-images.githubusercontent.com/67791317/145941230-4756110c-94e2-4b2d-ba6f-601e02613ce4.png){: .align-center}

두 분포 모두 종 모양의 분포가 나왔다. 붓스트랩 분포의 중심은 대략 90.88(표본에서 구한 기울기와 동일)이고 표준오차는 대략 21.5이다. 임의화 분포의 중심은 대략 0(영가설의 모수값)이다. 임의화 분포를 통해 반응변수의 유의성을 가설검증을 하는 것. 즉, 기울기가 0이다라는 영가설을 기각함으로써 붓스트랩 분포에서 구한 추정 기울기 90.88만큼 극단적인 것은 없다는 것이다. 해당 변수가 유의하다는 증거이다. 

위 결과를 통해 기울기에 추정에서 t분포를 사용할 수 있다는 것을 알 수 있다. 또한, 표준오차를 사용하여 신뢰구간을 구하거나 가설검증을 할 수 있다. 이때 t분포는 2개의 모수를 추정하기 때문에 자유도는 $$(n-1)$$이다. 

### 기울기의 추론 공식 

단순 선형모형을 적합하기 위한 모든 조건이 만족되면 아래와 같은 공식을 이용하면 된다. 

> 모집단의 기울기에 대한 신뢰구간

$$ 
표본 통계량 \pm t^* \cdot SE = b_1 \pm t^*SE
$$

> $$H_0 : \beta_1 = 0$$에 대한 가설검증

$$
t = \frac{표본 통계량 - 영가설의 모수값}{SE} = \frac{b_1 - 0}{SE} = \frac{b_1}{SE}
$$

$$b_1$$은 표본에서 구한 최소제곱 회귀선의 기울기이고 $$SE$$는 기울기의 표준오차이다. 신뢰구간과 가설검증에서 사용하는 분포는 자유도가 (r-1)인 t 분포이다. 

### 예시 

*분석은 r을 통해서 진행한다.*

```r

# 데이터 파일이 존재하는 url 
file_url <- "http://www.lock5stat.com/datasets2e/InkjetPrinters.csv"

# 데이터 만들기. 
inkjet <- read.csv(file_url)

# 선형모형 적합 - 회귀분석 실행
fit <- lm(Prime ~ ppm, data = inkjet)

# 회귀분석 결과 출력
summary(fit)

```

![image](https://user-images.githubusercontent.com/67791317/145942986-54a87031-f82a-4c21-83d1-f51c2441969c.png){: .align-center}

출력된 결과값에 의하면 $$b_1 = 90.88$$이고 표준오차 $$SE = 19.49$$이다. 자유도 (20-2) = 18인 t-분포에서 $$t^* = 2.10$$이므로 95% 신뢰구간은 

$$b_1 \pm t^* \cdot SE$$  
$$90.88 \pm 2.10(19.49)$$  
$$(49.95, 131.81)$$

기울기는 $49.95에서 $131.81 사이라고 95% 확신한다. 

모집단의 기울기에 대한 가설검증은 $$H_0 : \beta_1 = 0, H_\alpha : \beta_1 \neq 0$$이라고 가설을 설정할 때 검증을 위한 검증 통계량을 계산한다. 

$$
t = \frac{b_1 - 0}{SE} = \frac{90.88}{18.49} = 4.66
$$

자유도 18인 t-분포에서 4.66보다 큰 쪽의 면적 0.000097의 두배인 0.000194가 p값이다. p값이 매우 작으므로 영가설을 기각한다. 이는 인쇄 속도(PPM)이 잉크젯 프린터 가격 예측에 효과적인 변수라는 강력한 증거이다. 



